

library(ComplexHeatmap)
#Heatmap(mat1, row_split = split)

library(circlize) # >= 0.4.10
#col_fun1 = colorRamp2(c(-2, 0, 2), c("blue", "white", "red"))
#circos.heatmap(mat1, split = split, col = col_fun1)

setwd("~/Documents/Almond/AgeCohortProject/DSSAnalysis_DMRCalling/Heatmap/")
CG_0812 <- read.csv("CG_2008_2012_0.0001_HeatMap.csv", header = TRUE)
CG_0817 <- read.csv("CG_2008_2017_0.0001_Heatmap.csv", header = TRUE)
CG_1217 <- read.csv("CG_2012_2017_0.0001_HeatMap.csv", header = TRUE)

CG_2008 <- read.csv("CG_2008.csv", header = TRUE)
CG_2012 <- read.csv("CG_2012.csv", header = TRUE)
CG_2017 <- read.csv("CG_2017.csv", header = TRUE)

CHG_0812 <- read.csv("CHG_2008_2012_0.0001.csv", header = TRUE)
CHG_0817 <- read.csv("CHG_2008_2017_0.0001.csv", header = TRUE)
CHG_1217 <- read.csv("CHG_2012_2017_0.0001.csv", header = TRUE)

CHH_0812 <- read.csv("CHH_2008_2012_Heatmap.csv", header = TRUE)
CHH_0817 <- read.csv("CHH_2008_2017_Heatmap.csv", header = TRUE)
CHH_1217 <- read.csv("CHH_2012_2017_Heatmap.csv", header = TRUE)

#circos.heatmap(CG_0812, split = CG_0812$chr, col = col_fun1())
#circos.clear()

#circos.par("track.height" = 0.1)
#circos.initialize(CG_0812$chr, xlim = c(CG_0812$start, CG_0812$end))

str(CG_0812)
CG_0812$chr <- as.factor(CG_0812$chr)
CG_0817$chr <- as.factor(CG_0817$chr)
CG_1217$chr <- as.factor(CG_1217$chr)

CHG_0812$chr <- as.factor(CHG_0812$chr)
CHG_0817$chr <- as.factor(CHG_0817$chr)
CHG_1217$chr <- as.factor(CHG_1217$chr)

CG_2008$chr <- as.factor(CG_2008$chr)
CG_2012$chr <- as.factor(CG_2012$chr)
CG_2017$chr <- as.factor(CG_2017$chr)

CHH_0812$chr <- as.factor(CHH_0812$chr)
CHH_0817$chr <- as.factor(CHH_0817$chr)
CHH_1217$chr <- as.factor(CHH_1217$chr)

cytoband.df = read.table("NonpareilChrLen.txt", colClasses = c("character", "numeric", "numeric"), sep = "\t")
 
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
#col_fun = colorRamp2(c(min(CG_0812$diff.Methy, na.rm = TRUE), 0, max(CG_0812$diff.Methy, na.rm = TRUE)), c("green", "black", "red"))
#circos.genomicHeatmap(CG_0812, col = col_fun, side = "inside", border = "white")
#circos.genomicRainfall(CG_0812, pch = 16, cex = 0.4, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CG_1217, col = c("#009933"), track.height = 0.1)
circos.genomicDensity(CG_0812, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CG_0817, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CG Context DMRs", cex = 1)
circos.clear()

circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
#col_fun = colorRamp2(c(min(CG_0812$diff.Methy, na.rm = TRUE), 0, max(CG_0812$diff.Methy, na.rm = TRUE)), c("green", "black", "red"))
#circos.genomicHeatmap(CG_0812, col = col_fun, side = "inside", border = "white")
#circos.genomicRainfall(CG_0812, pch = 16, cex = 0.4, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHG_1217, col = c("#009933"), track.height = 0.1)
circos.genomicDensity(CHG_0812, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHG_0817, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHG Context DMRs", cex = 1)
circos.clear()

#circos.par("gap.degree" = rep(c(2, 4), 4))              
#circos.initializeWithIdeogram(cytoband.df)
#col_fun = colorRamp2(c(min(CG_0812$diff.Methy, na.rm = TRUE), 0, max(CG_0812$diff.Methy, na.rm = TRUE)), c("green", "black", "red"))
#circos.genomicHeatmap(CG_0812, col = col_fun, side = "inside", border = "white")
#circos.genomicRainfall(CG_0817, pch = 16, cex = 0.4, col = c("#FF000080", "#0000FF80"))
#circos.genomicDensity(CG_0817, col = c("#FF000080"), track.height = 0.1)
#circos.clear()

circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
#col_fun = colorRamp2(c(min(CG_0812$diff.Methy, na.rm = TRUE), 0, max(CG_0812$diff.Methy, na.rm = TRUE)), c("green", "black", "red"))
#circos.genomicHeatmap(CG_0812, col = col_fun, side = "inside", border = "white")
#circos.genomicRainfall(CG_0812, pch = 16, cex = 0.4, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CG_2008, col = c("#009933"), track.height = 0.1)
circos.genomicDensity(CG_2012, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CG_2017, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CG methylation", cex = 1)
circos.clear()

circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
#col_fun = colorRamp2(c(min(CG_0812$diff.Methy, na.rm = TRUE), 0, max(CG_0812$diff.Methy, na.rm = TRUE)), c("green", "black", "red"))
#circos.genomicHeatmap(CG_0812, col = col_fun, side = "inside", border = "white")
#circos.genomicRainfall(CG_0812, pch = 16, cex = 0.4, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHH_1217, col = c("#009933"), track.height = 0.1)
circos.genomicDensity(CHH_0812, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHH_0817, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHH Context DMRs", cex = 1)
circos.clear()

CG_0812_Hyper <- read.csv("CG_2008_2012_Hyper.csv", header = TRUE)
CG_0812_Hypo <- read.csv("CG_2008_2012_Hypo.csv", header = TRUE)
CG_0812_Hyper$chr <- as.factor(CG_0812_Hyper$chr)
CG_0812_Hypo$chr <- as.factor(CG_0812_Hypo$chr)

CG_0817_Hyper <- read.csv("CG_2008_2017_Hyper.csv", header = TRUE)
CG_0817_Hypo <- read.csv("CG_2008_2017_Hypo.csv", header = TRUE)
CG_0817_Hyper$chr <- as.factor(CG_0817_Hyper$chr)
CG_0817_Hypo$chr <- as.factor(CG_0817_Hypo$chr)

CG_1217_Hyper <- read.csv("CG_2012_2017_Hyper.csv", header = TRUE)
CG_1217_Hypo <- read.csv("CG_2012_2017_Hypo.csv", header = TRUE)
CG_1217_Hyper$chr <- as.factor(CG_1217_Hyper$chr)
CG_1217_Hypo$chr <- as.factor(CG_1217_Hypo$chr)

bed_list = list(CG_0812_Hyper, CG_0812_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CG_0812_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CG_0812_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CG DMRs 11 vs 7", cex = 1)
circos.clear()

bed_list2 = list(CG_0817_Hyper, CG_0817_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list2, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CG_0817_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CG_0817_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CG DMRs 11 vs 2", cex = 1)
circos.clear()

bed_list3 = list(CG_1217_Hyper, CG_1217_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list3, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CG_1217_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CG_1217_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CG DMRs 7 vs 2", cex = 1)
circos.clear()

CHG_0812_Hyper <- read.csv("CHG_2008_2012_Hyper.csv", header = TRUE)
CHG_0812_Hypo <- read.csv("CHG_2008_2012_Hypo.csv", header = TRUE)
CHG_0812_Hyper$chr <- as.factor(CHG_0812_Hyper$chr)
CHG_0812_Hypo$chr <- as.factor(CHG_0812_Hypo$chr)

CHG_0817_Hyper <- read.csv("CHG_2008_2017_Hyper.csv", header = TRUE)
CHG_0817_Hypo <- read.csv("CHG_2008_2017_Hypo.csv", header = TRUE)
CHG_0817_Hyper$chr <- as.factor(CHG_0817_Hyper$chr)
CHG_0817_Hypo$chr <- as.factor(CHG_0817_Hypo$chr)

CHG_1217_Hyper <- read.csv("CHG_2012_2017_Hyper.csv", header = TRUE)
CHG_1217_Hypo <- read.csv("CHG_2012_2017_Hypo.csv", header = TRUE)
CHG_1217_Hyper$chr <- as.factor(CHG_1217_Hyper$chr)
CHG_1217_Hypo$chr <- as.factor(CHG_1217_Hypo$chr)

bed_list4 = list(CHG_0812_Hyper, CHG_0812_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list4, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHG_0812_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHG_0812_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHG DMRs 11 vs 7", cex = 1)
circos.clear()

bed_list5 = list(CHG_0817_Hyper, CHG_0817_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list5, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHG_0817_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHG_0817_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHG DMRs 11 vs 2", cex = 1)
circos.clear()

bed_list6 = list(CHG_1217_Hyper, CHG_1217_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list6, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHG_1217_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHG_1217_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHG DMRs 7 vs 2", cex = 1)
circos.clear()

CHH_0812_Hyper <- read.csv("CHH_2008_2012_Hyper.csv", header = TRUE)
CHH_0812_Hypo <- read.csv("CHH_2008_2012_Hypo.csv", header = TRUE)
CHH_0812_Hyper$chr <- as.factor(CHH_0812_Hyper$chr)
CHH_0812_Hypo$chr <- as.factor(CHH_0812_Hypo$chr)

CHH_0817_Hyper <- read.csv("CHH_2008_2017_Hyper.csv", header = TRUE)
CHH_0817_Hypo <- read.csv("CHH_2008_2017_Hypo.csv", header = TRUE)
CHH_0817_Hyper$chr <- as.factor(CHH_0817_Hyper$chr)
CHH_0817_Hypo$chr <- as.factor(CHH_0817_Hypo$chr)

CHH_1217_Hyper <- read.csv("CHH_2012_2017_Hyper.csv", header = TRUE)
CHH_1217_Hypo <- read.csv("CHH_2012_2017_Hypo.csv", header = TRUE)
CHH_1217_Hyper$chr <- as.factor(CHH_1217_Hyper$chr)
CHH_1217_Hypo$chr <- as.factor(CHH_1217_Hypo$chr)

bed_list7 = list(CHH_0812_Hyper, CHH_0812_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list7, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHH_0812_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHH_0812_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHH DMRs 11 vs 7", cex = 1)
circos.clear()

bed_list8 = list(CHH_0817_Hyper, CHH_0817_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list8, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHH_0817_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHH_0817_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHH DMRs 11 vs 2", cex = 1)
circos.clear()

bed_list9 = list(CHH_1217_Hyper, CHH_1217_Hypo)
circos.par("gap.degree" = rep(c(2, 4), 4))              
circos.initializeWithIdeogram(cytoband.df)
circos.genomicRainfall(bed_list9, pch = 16, cex = 0.3, col = c("#FF000080", "#0000FF80"))
circos.genomicDensity(CHH_1217_Hyper, col = c("#FF000080"), track.height = 0.1)
circos.genomicDensity(CHH_1217_Hypo, col = c("#0000FF80"), track.height = 0.1)
text(0, 0, "CHH DMRs 7 vs 2", cex = 1)
circos.clear()



