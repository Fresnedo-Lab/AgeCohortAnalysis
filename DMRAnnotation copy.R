library(genomation)
library(GenomicRanges)

setwd("~/Documents/Almond/AgeCohortProject/DSSAnalysis_DMRCalling/Heatmap/VennDiagrams/")
CG_0812_Hyp <- readBed("CG_0812_Hyp.txt")
CG_0812_Hypo <- readBed("CG_0812_Hypo.txt")
CG_1217_Hyp <- readBed("CG_1217_Hyp.txt")
CG_1217_Hypo <- readBed("CG_1217_Hypo.txt")
CG_0817_Hyp <- readBed("CG_0817_Hyp.txt")
CG_0817_Hypo <- readBed("CG_0817_Hypo.txt")

CHG_0812_Hyp <- readBed("CHG_0812_Hyp.txt")
CHG_0812_Hypo <- readBed("CHG_0812_Hypo.txt")
CHG_1217_Hyp <- readBed("CHG_1217_Hyp.txt")
CHG_1217_Hypo <- readBed("CHG_1217_Hypo.txt")
CHG_0817_Hyp <- readBed("CHG_0817_Hyp.txt")
CHG_0817_Hypo <- readBed("CHG_0817_Hypo.txt")

CHH_0812_Hyp <- readBed("CHH_0812_Hyp.txt")
CHH_0812_Hypo <- readBed("CHH_0812_Hypo.txt")
CHH_1217_Hyp <- readBed("CHH_1217_Hyp.txt")
CHH_1217_Hypo <- readBed("CHH_1217_Hypo.txt")
CHH_0817_Hyp <- readBed("CHH_0817_Hyp.txt")
CHH_0817_Hypo <- readBed("CHH_0817_Hypo.txt")

gffNon <- gffToGRanges("~/Documents/Almond/AgeCohortProject/DSSAnalysis_DMRCalling/Almond_Feb_2021_with_functional_info.gff.gz")
gffNon = as(split(gffNon, gffNon$type), "GRangesList")

annotateWithFeatures(CG_0812_Hyp, gffNon)
annotateWithFeatures(CG_0812_Hypo, gffNon)
annotateWithFeatures(CG_1217_Hyp, gffNon)
annotateWithFeatures(CG_1217_Hypo, gffNon)
annotateWithFeatures(CG_0817_Hyp, gffNon)
annotateWithFeatures(CG_0817_Hypo, gffNon)

annotateWithFeatures(CHG_0812_Hyp, gffNon)
annotateWithFeatures(CHG_0812_Hypo, gffNon)
annotateWithFeatures(CHG_1217_Hyp, gffNon)
annotateWithFeatures(CHG_1217_Hypo, gffNon)
annotateWithFeatures(CHG_0817_Hyp, gffNon)
annotateWithFeatures(CHG_0817_Hypo, gffNon)

annotateWithFeatures(CHH_0812_Hyp, gffNon)
annotateWithFeatures(CHH_0812_Hypo, gffNon)
annotateWithFeatures(CHH_1217_Hyp, gffNon)
annotateWithFeatures(CHH_1217_Hypo, gffNon)
annotateWithFeatures(CHH_0817_Hyp, gffNon)
annotateWithFeatures(CHH_0817_Hypo, gffNon)
